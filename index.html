<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CANO FLIX</title>
    <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet" />
    <style>
        :root { --main: #e50914; --bg: #000; --card-bg: #141414; }
        body { background: var(--bg); color: #fff; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; margin: 0; overflow-x: hidden; }
        
        /* Navbar */
        nav { position: fixed; top: 0; width: 100%; height: 70px; background: linear-gradient(to bottom, rgba(0,0,0,0.9), transparent); display: flex; align-items: center; padding: 0 4%; box-sizing: border-box; z-index: 1000; transition: 0.5s; }
        .logo { color: var(--main); font-size: 30px; font-weight: bold; margin-right: 25px; cursor: pointer; }
        .search-box { background: rgba(0,0,0,0.5); border: 1px solid #fff; padding: 5px 10px; display: flex; align-items: center; border-radius: 4px; }
        .search-box input { background: transparent; border: none; color: #fff; outline: none; width: 200px; }

        /* Hero Player Section */
        .hero-player { width: 100%; height: 56.25vw; max-height: 80vh; background: #000; position: relative; margin-bottom: -50px; }
        .video-js { width: 100%; height: 100%; }

        /* Row Tasarımı (Netflix Style) */
        .row { padding: 20px 0 20px 4%; }
        .row-title { font-size: 1.4vw; font-weight: bold; margin-bottom: 10px; color: #e5e5e5; }
        .row-posters { display: flex; overflow-x: scroll; overflow-y: hidden; padding: 20px 0; scroll-behavior: smooth; }
        .row-posters::-webkit-scrollbar { display: none; }
        
        .poster { max-height: 250px; object-fit: contain; width: 100%; transition: transform 450ms; margin-right: 10px; cursor: pointer; border-radius: 4px; background: var(--card-bg); }
        .poster:hover { transform: scale(1.08); opacity: 1; }
        .poster-card { position: relative; min-width: 160px; }
        .poster-title { font-size: 12px; text-align: center; margin-top: 5px; color: #808080; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        @media (max-width: 768px) {
            .row-title { font-size: 18px; }
            .poster { max-height: 180px; min-width: 120px; }
            nav { background: #000; height: 60px; }
        }
    </style>
</head>
<body>

<nav id="navbar">
    <div class="logo">CANOFLIX</div>
    <div class="search-box">
        <input type="text" id="searchInput" placeholder="Film, dizi ara..." onkeyup="ara()">
    </div>
</nav>

<div class="hero-player">
    <video id="main-player" class="video-js vjs-big-play-centered" controls preload="auto" poster="https://via.placeholder.com/1920x1080?text=CANO+FLIX"></video>
</div>

<div id="content-rows">
    </div>

<script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
<script>
    const player = videojs('main-player');
    let allData = [];

    async function init() {
        const res = await fetch('./filmler.json');
        allData = await res.json();
        
        // Veriyi Kategorilere Grupla
        const groups = allData.reduce((acc, item) => {
            const cat = item.kategori || "Genel";
            if (!acc[cat]) acc[cat] = [];
            acc[cat].push(item);
            return acc;
        }, {});

        const container = document.getElementById('content-rows');
        
        for (let catName in groups) {
            let row = document.createElement('div');
            row.className = 'row';
            row.innerHTML = `<div class="row-title">${catName}</div>`;
            
            let posters = document.createElement('div');
            posters.className = 'row-posters';
            
            // Performans için her kategoriden ilk 40 taneyi göster
            groups[catName].slice(0, 40).forEach(item => {
                posters.innerHTML += `
                    <div class="poster-card" onclick="playVideo('${item.link}')">
                        <img class="poster" src="${item.resim}" loading="lazy" onerror="this.src='https://via.placeholder.com/160x240?text=${item.tip}'">
                        <div class="poster-title">${item.baslik}</div>
                    </div>
                `;
            });
            
            row.appendChild(posters);
            container.appendChild(row);
        }
    }

    function playVideo(url) {
        window.scrollTo({top: 0, behavior: 'smooth'});
        player.src({ type: 'application/x-mpegURL', src: url });
        player.play();
    }

    function ara() {
        // Basit arama mantığı - tümünü süzmek yerine bir sonuç ekranı açılabilir
        let val = document.getElementById('searchInput').value.toLowerCase();
        if(val.length > 2) {
            // Arama sonuçları için özel bir row açabiliriz
            console.log("Aranıyor: " + val);
        }
    }

    // Scroll efekti
    window.addEventListener('scroll', () => {
        if (window.scrollY > 100) document.getElementById('navbar').style.backgroundColor = '#000';
        else document.getElementById('navbar').style.background = 'linear-gradient(to bottom, rgba(0,0,0,0.9), transparent)';
    });

    window.onload = init;
</script>
</body>
</html>
